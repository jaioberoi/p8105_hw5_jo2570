---
title: "hw5_jo2570"
author: "Jai Oberoi"
date: "02/11/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
set.seed(10)

iris_with_missing = iris %>% 
  janitor::clean_names() %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(species = as.character(species))

```

Problem 1: 

Replacing the missing values:
```{r}
replace_values = function(x) {
  if (is.numeric(x) == TRUE) {
    x = x %>% replace_na(round(mean(x, na.rm = TRUE, 2)))
    }
  if (is.character(x) == TRUE) {
    x = x %>% replace_na("virginica")
    }

return(x)
  
}

iris_with_missing = map_df(iris_with_missing, replace_values)
```


Problem 2: 

Creating a tidy dataset from the sperate files: 
```{r}
tidy_df = list.files(path = "./data", full.names = TRUE) %>% 
  map(read.csv) %>% 
  reduce(rbind) %>% 
  mutate(
    subject_id = c(1:20), 
    arm = ifelse(subject_id == c(1:10), "control", "experimental")
  ) 
```

Creating a spaghetti plot showing observations on each subject over time: 
```{r}
plot1 = tidy_df %>% 
  pivot_longer(week_1:week_8,
    names_to = "week",
    values_to = "obs") %>% 
  ggplot(aes(x = week, y = obs, color = arm, group = subject_id)) + geom_line()

plot1
```

Plot 1 shows the observations of each particpant over time in weeks (weeks each datapoint for each participant was collected). The participants are grouped into experimental and control. The plot shows us that observations for the experimental group increase with time, while observations for the control group are more consistant, on average. 


